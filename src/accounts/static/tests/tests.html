<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Javascript tests</title>
  <link rel="stylesheet" href="../../../superlists/static/tests/qunit.css">
</head>

<body>
  <div id="qunit"></div>
  <div id="qunit-fixture">
      <a id="id_login">Sign in</a>
  </div>

  <div id="qunit-fixture">
    <a id="id_login">Sign in</a>
  </div>
  <script type="text/javascript" src="../../../superlists/static/jquery.js"></script>
  <script type="text/javascript" src="../../../superlists/static/tests/qunit.js"></script>
  <script type="text/javascript" src="../accounts.js"></script>
  <script type="text/javascript">
/*global $. test, equal, sinon, Superlists */

test('initialize binds sign in button to navigator.id.request', function(){
  var requestWasCalled = false;
  var mockRequestFunction = function(){requestWasCalled = true;};
  var mockNavigator = {
    id: {
      request: mockRequestFunction
    }
  };

  Superlists.Accounts.initialize(mockNavigator);
  equal(requestWasCalled, false, 'check request not called before click')
  $('#id_login').trigger('click');
  equal(requestWasCalled, true);
});
  </script>
